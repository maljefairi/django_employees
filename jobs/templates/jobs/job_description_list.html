{% extends "jobs/base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-12">
        <form method="GET" action="" id="search-form"> 
            <div class="form-row">
                <div class="col">
                    <input type="text" class="form-control" name="title" placeholder="Job Title" value="{{ request.GET.title|default:'' }}">
                </div>
                <div class="col">
                    <input type="text" class="form-control" name="grade" placeholder="Grade" value="{{ request.GET.grade|default:'' }}">
                </div>
                <div class="col">
                    <input type="text" class="form-control" name="group_type" placeholder="Group Type" value="{{ request.GET.group_type|default:'' }}">
                </div>
            </div>
            <div class="col-auto mt-2">
                <button type="submit" class="btn btn-primary">Search</button>
                <button type="button" class="btn btn-secondary" id="reset-button">Reset</button>
            </div>
        </form>
    </div>
</div>

<div class="table-responsive table-sm">
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Job Title</th>
                <th>Grade</th>
                <th>Code</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for description in job_descriptions %}
            <tr>
                <td><a href="{% url 'job_description_detail' description.id %}">{{ description.job_title.title }}</a></td>
                <td>{{ description.grade }}</td>
                <td>{{ description.code }}</td>
                <td>
                    <a href="{% url 'job_description_edit' description.id %}">Edit</a> |
                    <a href="{% url 'job_description_delete' description.pk %}">Delete</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4">No job descriptions found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="pagination">
    <span class="step-links">
        {% if job_descriptions.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ job_descriptions.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ job_descriptions.number }} of {{ job_descriptions.paginator.num_pages }}.
        </span>

        {% if job_descriptions.has_next %}
            <a href="?page={{ job_descriptions.next_page_number }}">next</a>
            <a href="?page={{ job_descriptions.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
</div>

<script>
    document.getElementById('reset-button').addEventListener('click', function() {
        var form = document.getElementById('search-form');
        var inputs = form.getElementsByTagName('input');
    
        for(var i = 0; i < inputs.length; i++) {
            if (inputs[i].name !== 'csrfmiddlewaretoken') {
                inputs[i].value = "";
            }
        }
        form.submit();
    });
</script>
{% endblock %}
